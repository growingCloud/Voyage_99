<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- SUMMER NOTE : include libraries(jQuery, bootstrap) -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <!-- SUMMER NOTE : include summernote css/js -->
    <link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.js"></script>
    <style>
        .panel-heading.note-toolbar>* {
            display: none;
        }
        .panel-heading.note-toolbar{
            overflow:hidden;
        }
        .note-btn-group.btn-group.note-insert{
            display:block;
        }
        .note-btn-group.btn-group.note-insert>*:nth-child(odd){
            display:none;
        }
        .note-icon-picture::after{
            content:"ddddddddddddddd";
            display:inline;
            margin-left:10px;
        }
    </style>
    <script>
        $(document).ready(function() {
          $('#summernote').summernote({
                height: '100%',
                width: '70%',
                lang : 'ko-KR',
                popover: {
                    image: [],
                    link: [],
                    air: []
                },
              callbacks: {
                    onImageUpload: function(image) {
                        for(let i = 0; i < image.length; i++)
                            uploadImage(image[i]);
                    }
              }
          })
        })

        function uploadImage(image) {
            let data = new FormData();
            data.append("image", image)
            $.ajax({
                url: "{{url_for('upload_image')}}",
                cache: false,
                contentType: false,
                processData: false,
                data: data,
                type: "post",
                success: function(url) {
                    let image = $("<img>").attr("src", url).css('max-width', "900px");
                    $("#summernote").summernote("insertNode", image[0]);
                },
                error: function (data) {
                    console.log(data);
                    alert(data);
                }
            });
        }
    </script>


    <title>골라보세요 벨런스게임!</title>
</head>
    <body>
        <article>
            <form id='write_form' name="form" method="POST" action="/post" >
                <ul>
                    <li>
                        <p>작성자</p>
                        <input type="text" name="name">
                    </li>
                    <li>
                        <p>이미지 제목 (Left)</p>
                        <input type="text" name="imgtitle_L">
                        <p>이미지 제목 (Right)</p>
                        <input type="text" name="imgtitle_R">
                    </li>
                    <li class='summer'>
                        <p>자유롭게 설명을 적어주세요!</p>
                        <textarea name="contents" id="summernote"></textarea>
                    </li>
                    <li>
                        <label class="btn" for="write">게임 만들기</label>
                        <input type="submit" id="write" style="display:none;">
                    </li>
                </ul>
            </form>
        </article>
    </section>
    <script>

        const form = document.querySelector('#write_form');
        form.addEventListener('submit',(e)=>{
            const title = document.querySelector('input[name="title"]').value;
            const desc = document.querySelector('.note-editable>p').innerText;
            if(title ==''|| desc == ''){
            e.preventDefault();
            alert('빈칸을 입력해 주세요')
            return false;
            }
        })
    </script>
    </body>
</html>